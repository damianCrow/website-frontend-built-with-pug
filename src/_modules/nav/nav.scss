// nav styles

.toggle-nav {
  position: absolute;
  left: 0;

  width: 100%;
  // padding: 0 $primary-gutter;

  $root: &;

  &__list {
    display: flex;
    flex-direction: column;
    // contain: strict;

    width: 100%;
    height: 100%;
    margin: 0;
    padding: 0 ($primary-gutter + $half-gutter);

    list-style: none;

    // TODO: Get this to work with 'strict', aka with 'size'.
    // contain: layout style paint;
    align-items: flex-start;
    justify-content: flex-start;

    &--root {
      #{$root}__item {
        &:last-child {
          &::after {
            position: absolute;
            top: calc(100% + 1px);
            left: 0;

            width: 100%;
            height: 100vh;

            content: '';

            background-color: palette(brown, dark);
          }        
        }
      }      
    }
  }

  &__item {
    position: relative;
    z-index: 1;

    width: 100%;

    cursor: pointer;
    // closing 
    transition: transform 400ms $timing-function-fast-out-slow-in 250ms;

    border-top: 1px solid palette(gray, warm);
    background: palette(brown, dark);

    &:last-child {
      border-bottom: 1px solid palette(gray, warm);
    }

    &--sub-item {
      background-color: #2c2a28;
      &:last-child {
        border-bottom: 0;
      }
    }

    &--sub-nav-container {
      #{$root}__link {
        &::after {
          position: absolute;
          top: $primary-gutter;
          right: 0;
          bottom: 0;

          display: inline-block;

          width: .45em;
          height: .45em;
          margin-right: $primary-gutter;
          margin-left: auto;

          content: '';
          transition: transform 250ms $timing-function-fast-out-slow-in;
          transform: rotate(-225deg);
          vertical-align: top;
          pointer-events: none;

          border-width: .05em .05em 0 0;
          border-style: solid;
          border-color: palette(gray, warm);

          font-size: initial;

          contain: strict;
        }        
      }
    }

    &--sub-sub-nav-container {
      #{$root}__sub-link {
        &::after {
          position: absolute;
          top: $primary-gutter;
          right: 0;
          bottom: 0;

          display: inline-block;

          width: .45em;
          height: .45em;
          margin-right: $primary-gutter;
          margin-left: auto;

          content: '';
          transition: transform 250ms $timing-function-fast-out-slow-in;
          transform: rotate(-225deg);
          vertical-align: top;
          pointer-events: none;

          border-width: .05em .05em 0 0;
          border-style: solid;
          border-color: palette(gray, warm);

          font-size: initial;

          contain: strict;
        }        
      }

      #{$root}__item--sub-item {
        background-color: black;

        span {
          display: inline-block;
          transform: translateX($primary-gutter);
        }
      }
    }

    &--active-sub-nav {
      // opening
      transition: transform 400ms $timing-function-fast-out-slow-in;
      #{$root}__link {
        span {
          transform: translateX(1rem);

          @extend %typography-open-nav-section;
        }
        &::after {
          transition: transform 250ms $timing-function-fast-out-slow-in 150ms;
          transform: rotate(-45deg);
        }
      }
      #{$root}__sub-nav {
        // opening
        transition: opacity 400ms $timing-function-fast-out-slow-in 250ms;

        opacity: 1;
      }
    }
  }

  &__sub-nav {
    margin: 0 -#{$primary-gutter + $half-gutter};
    padding: 0 #{$primary-gutter + $half-gutter};

    list-style: none;
    // closing

    transition: opacity 250ms $timing-function-fast-out-slow-in;

    opacity: 0;
    // background-color: palette(brown, base);
  }

  &__link {
    display: inline-block;

    box-sizing: border-box;
    padding: $half-gutter 0;

    height: 50px;

    cursor: pointer;
    text-decoration: none;

    @extend %typography-nav-section;

    > span {
      transition: transform 325ms $timing-function-ease-out-quint, $color-transistion 125ms;
      display: inline-block;
    }

  }

  &__sub-link {
    display: inline-block;

    box-sizing: border-box;

    padding: $primary-gutter;

    height: 50px;

    text-decoration: none;

    span {
      @extend %typography-title-v-one;

    }
  }

  &--animated-height {
    #{$root}__item--sub-nav-container {
      transition: height 400ms $timing-function-fast-out-slow-in;
    }
  }

  &--side {
    overflow: hidden;

    transition: transform 400ms $timing-function-fast-out-slow-in;

    #{$root}__list {
      padding: 0;
    }

    #{$root}__item {
      padding: 0 $primary-gutter;
    }

    #{$root}__sub-link {}

    @media #{$mq-desktop-small-up} {
      position: relative;
      // Stop the fold-up from mobile.

      transform: none !important;
    }
  }

  &--bright {
    background-color: palette(gray, white);

    #{$root}__item {
      border-top: 1px solid palette(gray, border);
      border-left: 1px solid palette(gray, border);

      &--sub-item {
        padding: 0;
      }

      &--active-sub-nav {
        border-left: 1px solid palette(gray, border);

        #{$root}__link {
          > span {
            @extend %typography-side-nav-item;
          }
        }

        #{$root}__item {
          border-left: 1px solid palette(gray, border);
        }
      }

      &:last-child {
        border-bottom: 1px solid palette(gray, border);
      }
    }

    &[data-start-shut] {
      transition: none;
    }

    #{$root}__link {
      margin: $primary-gutter 0;

      @extend %typography-side-nav-item;
    }

    #{$root}__sub-link {
      > span {
        margin: 0;

        opacity: .5;

        @extend %typography-side-nav-sub-item;
      }
    }

    #{$root}__sub-nav {
      background-color: palette(gray, light);
    }

  }
}

